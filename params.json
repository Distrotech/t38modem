{"name":"T38modem","tagline":"","body":"/*\r\n * README\r\n *\r\n * T38FAX Pseudo Modem\r\n *\r\n * Original author: Vyacheslav Frolov\r\n *\r\n */\r\n\r\n1. Introduction\r\n---------------\r\n\r\nWhat is t38modem?\r\n\r\nFrom your fax or voice application view point it's a fax/voice modem pool.\r\nFrom IP network view point it's a H.323/SIP endpoint with T.38 fax support.\r\nFrom your view point it's a gateway between an application and IP network.\r\n\r\nThe homepage for t38modem project is http://t38modem.sourceforge.net/.\r\n\r\n2. Building\r\n-----------\r\n\r\n2.1. Building for Unix\r\n----------------------\r\n\r\nBuilding with Open H323 Library:\r\n\r\n  $ export PWLIBDIR=$path_to_libs/pwlib\r\n  $ export OPENH323DIR=$path_to_libs/openh323\r\n  $ make NO_PBOOLEAN=1 opt\r\n\r\nBuilding with H323 Plus Library:\r\n\r\n  $ export PTLIBDIR=$path_to_libs/ptlib\r\n  $ export OPENH323DIR=$path_to_libs/h323plus\r\n  $ make opt\r\n\r\nBuilding with Open Phone Abstraction Library (OPAL):\r\n\r\n  $ export PTLIBDIR=$path_to_libs/ptlib\r\n  $ export OPALDIR=$path_to_libs/opal\r\n  $ make USE_OPAL=1 opt\r\n\r\n2.2. Building for Windows\r\n-------------------------\r\n\r\nBuilding with Open H323 Library:\r\n\r\n  Start Microsoft Visual C++ 2005 with h323lib\\t38modem_openh323_2005.vcproj file.\r\n  Set Active Configuration to \"t38modem - Win32 Release\".\r\n  Build t38modem.exe.\r\n\r\nBuilding with H323 Plus Library:\r\n\r\n  Start Microsoft Visual C++ 2005 with h323lib\\t38modem_2005.vcproj file.\r\n  Set Active Configuration to \"t38modem - Win32 Release\".\r\n  Build t38modem.exe.\r\n\r\nBuilding with Open Phone Abstraction Library (OPAL):\r\n\r\n  Start Microsoft Visual C++ 2005 with opal\\t38modem_2005.vcproj file.\r\n  Set Active Configuration to \"t38modem - Win32 Release\".\r\n  Build t38modem.exe.\r\n\r\n3. Examples\r\n-----------\r\n\r\nTo get info about t38modem command line syntax enter:\r\n\r\n  $ t38modem --help\r\n\r\n\r\n3.1. Starting\r\n-------------\r\n\r\nStarting with Open H323 Library or H323 Plus Library:\r\n\r\n  $ t38modem -n -o trace.log -p ttyx0,ttyx1 --old-asn \\\r\n                               --route 0@127.0.0.1 --route all@172.16.33.21\r\n\r\nThis will create two modems (/dev/ttyx0 and /dev/ttyx1) and H.323 endpoint.\r\nIf dialed number begins with '0' then it will be routed to a local host\r\n(leading '0' will be discarded). Other dialed numbers will be routed to\r\n172.16.33.21.\r\n\r\nStarting with OPAL:\r\n\r\n  $ t38modem -n -o trace.log -p ttyx0,ttyx1 \\\r\n                               --route \"modem:0.*=h323:<dn!1>@127.0.0.1\" \\\r\n                               --route \"modem:1.*=sip:<dn>@172.16.33.20\" \\\r\n                               --route \"modem:2.*=h323:<dn>@172.16.33.21\" \\\r\n                               --route \"h323:.*=modem:<dn>\" \\\r\n                               --route \"sip:.*=modem:<dn>\"\r\n\r\nThis will create two modems (/dev/ttyx0 and /dev/ttyx1) and H.323 and SIP endpoints.\r\nIf dialed number begins with '0' then it will be routed to a local host.\r\nIf dialed number begins with '1' then it will be routed to SIP endpoint 172.16.33.20.\r\nIf dialed number begins with '2' then it will be routed to H.323 endpoint 172.16.33.21.\r\nLeading '0', '1' and '2' will be discarded.\r\n\r\nQ. I try to use T38modem, but after run \"t38modem -p ttyx0\" I get a message\r\n   \"Could not open /dev/ptyx0: No such file or directory\".\r\nA. Looks like you don't have legacy PTY devices compiled in your kernel.\r\n   You need to re-compile the kernel with 'Legacy PTY Support'.\r\n   Alternatively, you can build t38modem with USE_UNIX98_PTY=1 option and use\r\n   -p +/dev/ttyx0,+/dev/ttyx1 instead of -p ttyx0,ttyx1.\r\n\r\nFreeBSD Users: You need to use  -p ttypa,ttypb instead of -p ttyx0,ttyx1.\r\n               Remember to replace ttyx0 with ttypa and ttyx1 with ttypb\r\n               when following the rest of these instructions.\r\n               This will create two modems /dev/ttypa and /dev/ttypb.\r\n\r\nWindows Users: You need two COM ports connected via Null-modem cable to create one modem.\r\n               If your COM1 connected to COM2 and COM3 connected to COM4 you need to use\r\n               -p \\\\.\\COM2,\\\\.\\COM4 instead of  -p ttyx0,ttyx1.\r\n               This will create two modems COM1 and COM3.\r\n               Q. How to use t38modem without additional COM port hardware on Windows?\r\n               A. Replace a pair of physical COM ports with a pair of virtual COM ports.\r\n                  See http://com0com.sourceforge.net/ project for details.\r\n               Q. What model of modem to select in Add Hardware Wizard?\r\n               A. Select \"Standard 1440 bps Modem\".\r\n\r\nCisco Users:   Possible additionaly you will need to use --h245tunneldisable option.\r\n\r\n3.2. Testing (you need two consoles)\r\n------------------------------------\r\n(FreeBSD users - remeber to use /dev/ttypa and /dev/ttypb with 'cu -l')\r\n(Windows users - use COM1 and COM3 with HyperTerminal)\r\n\r\n$ cu -l /dev/ttyx0\t    $ cu -l /dev/ttyx1\r\nConnected.\t\t    Connected.\r\n<-- at\t\t            <-- at\r\n--> OK                      --> OK\r\n                            (wait at least 10 secs)\r\n<-- atdt012345\r\n\r\n                            -->\r\n                            --> RING\r\n                            -->\r\n                            --> RING\r\n                            <-- ati9\r\n                            --> NDID = 12345\r\n                            --> OK\r\n                            -->\r\n                            --> RING\r\n                            -->\r\n                            --> RING\r\n                            <-- ata\r\n--> CONNECT                 --> CONNECT\r\n<-- x\r\n--> OK\r\n<-- ath\r\n--> OK\r\n                            -->\r\n                            --> ERROR\r\n<-- at\r\n--> OK\r\n                            <-- at\r\n                            --> OK\r\n...                         ...\r\n\r\n\r\n3.3. Example of Cisco config (loopback)\r\n---------------------------------------\r\n\r\n10.0.2.12 --> Cisco port 2:D --E1-cable--> Cisco port 3:D --> 10.0.2.12\r\n\r\ndial-peer voice 3340 voip\r\n incoming called-number 3334....\r\n codec g711alaw\r\n fax rate 14400\r\n fax protocol t38 ls-redundancy 0 hs-redundancy 0\r\n\r\ndial-peer voice 3341 pots\r\n destination-pattern 3334....\r\n port 2:D\r\n forward-digits 7\r\n\r\ndial-peer voice 3342 pots\r\n incoming called-number 334....\r\n direct-inward-dial\r\n port 3:D\r\nexit\r\n\r\ndial-peer voice 3343 voip\r\n destination-pattern 334....\r\n session target ipv4:10.0.2.12\r\n codec g711alaw\r\n fax rate 14400\r\n fax protocol t38 ls-redundancy 0 hs-redundancy 0\r\nexit\r\n\r\n3.4. Example of HylaFAX modem config files\r\n------------------------------------------\r\n\r\nCopy HylaFAX/etc/config.ttyx to HylaFAX's etc directory\r\n\r\nCreate simbolic links:\r\n\r\nconfig.ttyx0 -> config.ttyx\r\nconfig.ttyx1 -> config.ttyx\r\n\r\nStart HylaFAX with new modems:\r\n\r\n$ .../faxgetty -D ttyx0\r\n$ .../faxgetty -D ttyx1\r\n\r\n(FreeBSD users - don't forget we are using ttypa and ttypb)\r\n\r\n4. AT commands specific to t38modem\r\n-----------------------------------\r\n\r\n4.1. AT#CID command\r\n-------------------\r\n\r\n4.1.1 Reporting Caller ID and DID after the first RING\r\n------------------------------------------------------\r\n\r\n#CID=0\t- disable Caller ID and DID reporting (default).\r\n#CID=1\t- enable only Caller ID reporting.\r\n#CID=10\t- enable Caller ID and DID reporting.\r\n#CID=11\t- enable only DID reporting.\r\n\r\nExample:\r\n\r\n<-- AT#CID=10\r\n--> OK\r\n--> RING\r\n--> DATE = <MMDD>              ; Caller ID\r\n--> TIME = <HHMM>              ; Caller ID\r\n--> NMBR = <calling number>    ; Caller ID\r\n--> NAME = <calling name>      ; Caller ID\r\n--> NDID = <called number>     ; DID\r\n--> RING\r\n--> RING\r\n\r\n4.2. ATI command\r\n----------------\r\n\r\n4.2.1 calling/called number reporting\r\n-------------------------------------\r\n\r\nI8\t- reports calling number for last incoming call.\r\nI9\t- reports called number for last incoming call.\r\n\r\nExample:\r\n\r\n<-- ATI8I9\r\n--> NMBR = <calling number>\r\n--> NDID = <called number>\r\n--> OK\r\n\r\n4.3. ATD command\r\n----------------\r\n\r\n4.3.1 Fax mode modifiers\r\n------------------------\r\n\r\nF - force fax mode (T.38 or G.711 pass-trough) after dialing\r\n    (with OPAL can be overriden by route option OPAL-Force-Fax-Mode=false).\r\nV - do not force fax mode after dialing (default)\r\n    (with OPAL can be overriden by route option OPAL-Force-Fax-Mode=true).\r\n\r\nExamples:\r\n\r\n<-- ATDF<user's number>\r\n\r\n    force fax mode after dialing but user can override it by\r\n    inserting V into <user's number>.\r\n\r\n<-- ATD<user's number>V\r\n\r\n    do not force fax mode after dialing and user can't override it\r\n    by inserting F into <user's number>.\r\n\r\n4.3.2 calling/called number modifiers\r\n-------------------------------------\r\n\r\nL     - purge calling number and start dialing it.\r\nT,P,D - continue to dial of called number if dialing of calling number was started.\r\n\r\nIf calling number is empty after processing ATD command then t38modem's\r\nlocal party number used.\r\n\r\nThe calling number is a string of 0 or more of the characters:\r\n\r\n  \"0 1 2 3 4 5 6 7 8 9 * #\"\r\n\r\nNote: dialing of calling number is not allowed in online command state.\r\n\r\nThe called number is a string of 0 or more of the characters:\r\n\r\n  \"0 1 2 3 4 5 6 7 8 9 * # + A B C D\"\r\n\r\nNote: '+' will be ignored in online command state or after '@' modifier.\r\n\r\nExamples:\r\n\r\n<-- ATD<user's number>\r\n\r\n    calling number is t38modem's local party number but user can override\r\n    it by inserting L<user's calling number> into <user's number>\r\n\r\n<-- ATD<user's number>L\r\n\r\n    calling number is t38modem's local party number and user can't override\r\n    it by inserting L<user's calling number> into <user's number>\r\n\r\n<-- ATDL<calling number>T<user's number>\r\n\r\n    calling number is <calling number> but user can override\r\n    it by inserting L<user's calling number> into <user's number>\r\n\r\n<-- ATD<user's number>L<calling number>\r\n\r\n    calling number is <calling number> and user can't override\r\n    it by inserting L<user's calling number> into <user's number>\r\n\r\n4.3.3 Wait for answer modifier\r\n------------------------------\r\n\r\n@ - dial the called number part collected before first @, wait till the call\r\n    answered and play the called number part collected after last @.\r\n    Implicitly '@' will continue dialing of called number (see 4.3.2).\r\n\r\nExamples:\r\n\r\n<-- ATS8?\r\n--> 002\r\n--> OK\r\n<-- ATD12345@,,,4321\r\n\r\n    dial number 12345, wait till the call answered, wait 6 seconds\r\n    (3 commas * 2 seconds), play digits 4321.\r\n\r\n<-- ATD12345@,,,4321@\r\n\r\n    dial number 12345.\r\n\r\n4.4. AT#DFRMC command\r\n---------------------\r\n\r\n4.4.1 Set delay for CONNECT result code for AT+FRM command\r\n----------------------------------------------------------\r\n\r\n#DFRMC=0\t- disable delay (default).\r\n#DFRMC=25\t- set delay to 250 ms.\r\n\r\n4.5. AT#HCLR command\r\n--------------------\r\n\r\n4.5.1 Set clear call mode for ATH command\r\n-----------------------------------------\r\n\r\n#HCLR=0\t- ATH command will not clear not answered incoming call (default).\r\n#HCLR=1\t- ATH command will clear not answered incoming call.\r\n\r\n4.6. AT#CIDFMT command\r\n----------------------\r\n\r\nAT#CIDFMT command allows to set value format for NAME and NMBR tags of Caller ID.\r\n\r\nSyntax:\r\n\r\n  #CIDFMT=[<name format>][,[<nmbr format>]]\r\n\r\nIf a format element is empty then its value will be untouched.\r\n\r\nSubparameter <name format>:\r\n\r\n  0   - report \"NAME = <calling name>\" (default)\r\n  1   - report \"NAME = \"\r\n  2   - report \"NAME = <called number>\"\r\n  3   - report \"NAME = <called number> <- <calling name>\"\r\n\r\nSubparameter <nmbr format>:\r\n\r\n  0   - report \"NMBR = <calling number>\" (default)\r\n  1   - report \"NMBR = \"\r\n  2   - report \"NMBR = <called number>\"\r\n  3   - report \"NMBR = <called number>#<calling number>\"\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}